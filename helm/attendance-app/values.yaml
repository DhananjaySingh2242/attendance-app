# Default values for attendance-app
replicaCount: 1

image:
  repository: dhananjaysingh2242/attendance-app
  tag: "1.0"
  pullPolicy: IfNotPresent

service:
  type: NodePort
  port: 8081
  nodePort: 30007

# Optional: override app name/labels
nameOverride: ""
fullnameOverride: ""

# MySQL / Spring datasource (app connects to Service "mysql" in cluster)
spring:
  datasource:
    url: "jdbc:mysql://mysql:3306/attendance?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC"
    username: attendance
  jpa:
    databasePlatform: org.hibernate.dialect.MySQLDialect

# Secrets for env (existing k8s secret) - used for SPRING_DATASOURCE_PASSWORD
existingSecret:
  name: db-secret
  mysqlPasswordKey: mysql-password

# Keycloak - admin password and client secret from secret (create keycloak-secret in cluster)
keycloak:
  authServerUrl: "http://keycloak:8080"
  realm: "keycloak-demo"
  admin:
    clientId: "attendance-admin-client"
    clientSecret: ""
  existingSecret:
    name: keycloak-secret
    adminPasswordKey: admin-password
    clientSecretKey: client-secret

# Probes - startup allows slow boot; liveness gives app time to stabilize
probes:
  startup:
    initialDelaySeconds: 30
    periodSeconds: 10
    failureThreshold: 18
  readiness:
    initialDelaySeconds: 10
    periodSeconds: 10
    failureThreshold: 6
  liveness:
    initialDelaySeconds: 60
    periodSeconds: 15
    failureThreshold: 6

# Prod/K8s env (services in same namespace)
extraEnv:
  - name: SPRING_PROFILES_ACTIVE
    value: "prod"
  - name: MONGODB_HOST
    value: "mongodb"
  - name: RABBITMQ_HOST
    value: "rabbitmq"
  - name: REDIS_HOST
    value: "redis"
  - name: KEYCLOAK_ISSUER_URI
    value: "http://keycloak:8080/realms/keycloak-demo"
  - name: KEYCLOAK_ADMIN_REALM
    value: "master"
  - name: KEYCLOAK_ADMIN_USERNAME
    value: "admin"
  - name: SPRING_JPA_HIBERNATE_DDL_AUTO
    value: "update"
  - name: CORS_ALLOWED_ORIGINS
    value: "http://localhost:5173,http://localhost:3000"
